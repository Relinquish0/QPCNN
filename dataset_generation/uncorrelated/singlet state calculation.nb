(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32835,        714]
NotebookOptionsPosition[     30763,        674]
NotebookOutlinePosition[     31205,        692]
CellTagsIndexPosition[     31162,        689]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"theta", "=", "Pi"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", "Pi"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xa", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], " ", 
    RowBox[{"Cos", "[", "phi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ya", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], " ", 
    RowBox[{"Sin", "[", "phi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"za", " ", "=", " ", 
   RowBox[{"Cos", "[", "theta", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta", "=", "0.0000001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"+", "0.0000001"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xb", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], " ", 
    RowBox[{"Cos", "[", "phi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yb", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], " ", 
    RowBox[{"Sin", "[", "phi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zb", " ", "=", " ", 
   RowBox[{"Cos", "[", "theta", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Xita", " ", "=", " ", 
  RowBox[{"ArcCos", "[", 
   FractionBox[
    RowBox[{"zb", "-", "za"}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"zb", "-", "za"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"yb", "-", "\[IndentingNewLine]", "ya"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xb", "-", "xa"}], ")"}], "2"]}]]], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Phi", " ", "=", " ", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"yb", "-", "ya"}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{"xb", "-", "xa"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "(*", "\:968f\:673a\:8bbe\:7f6e\:5f52\:4e00\:5316\:65b9\:5411", 
   "*)"}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{
  3.92749749020887*^9, {3.927498555464223*^9, 3.9274985731202292`*^9}, {
   3.9278905188535643`*^9, 3.927890528868655*^9}, 3.9278906008826103`*^9, 
   3.9278906768345404`*^9, {3.9278908565311627`*^9, 3.9278908586088343`*^9}, 
   3.9278910053416386`*^9, {3.930087871389003*^9, 3.9300879361701393`*^9}, {
   3.930087970230687*^9, 3.9300879703706884`*^9}, {3.930088106831151*^9, 
   3.930088126175234*^9}, {3.930088206480582*^9, 3.9300882323040385`*^9}, {
   3.9300884868192897`*^9, 3.9300884960893555`*^9}, {3.9300885513534365`*^9, 
   3.9300885723962593`*^9}, {3.9300886207731233`*^9, 3.930088620933097*^9}, {
   3.9300887189790707`*^9, 3.930088737011089*^9}, {3.930088776418125*^9, 
   3.9300887775893598`*^9}, {3.930088839901705*^9, 3.9300888401219187`*^9}, {
   3.9300888714623623`*^9, 3.930088877212248*^9}, {3.9300902297949553`*^9, 
   3.9300902304951735`*^9}, 3.9300907248579793`*^9, {3.930090874477483*^9, 
   3.9300908773171453`*^9}, {3.930091097478041*^9, 3.930091098579521*^9}, {
   3.9300912741019125`*^9, 3.930091347229452*^9}, {3.9300914023212705`*^9, 
   3.930091544760062*^9}, {3.9300915923073225`*^9, 3.930091592447608*^9}, {
   3.9300916264735956`*^9, 3.9300917058115993`*^9}, {3.93009175277798*^9, 
   3.9300917601403847`*^9}, {3.9300918010231504`*^9, 
   3.9300918011938844`*^9}, {3.930091842702238*^9, 3.9300918519131055`*^9}, {
   3.9300923472919703`*^9, 3.9300923556635*^9}, 3.9300923882686996`*^9, {
   3.9300932507540674`*^9, 3.9300932558135977`*^9}, {3.930094790091218*^9, 
   3.9300948041833673`*^9}, {3.930095074717396*^9, 3.9300950903147388`*^9}, {
   3.9300961963270693`*^9, 3.930096196577675*^9}, {3.9300962294613647`*^9, 
   3.9300962785477543`*^9}, {3.9300963201233144`*^9, 
   3.9300964098001657`*^9}, {3.930096450579549*^9, 3.930096451429985*^9}, 
   3.9300965348062897`*^9, {3.9300966606664343`*^9, 3.930096750188881*^9}, {
   3.9300969042373066`*^9, 3.9300969098969564`*^9}, {3.9300969602960405`*^9, 
   3.9300969784807367`*^9}, {3.930097057947494*^9, 3.9300970595470843`*^9}, {
   3.9300971197347846`*^9, 3.9300971200148993`*^9}, {3.9300971514863605`*^9, 
   3.9300971527527876`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[1377]:=",ExpressionUUID->"158d709d-4703-41e1-b1c8-3a1ba8ccaa91"],

Cell[BoxData["4.712160915387242`*^-8"], "Output",
 CellChangeTimes->{
  3.927455600169839*^9, 3.9274563189409957`*^9, 3.9274974529990573`*^9, 
   3.9274974908612156`*^9, 3.927497621805256*^9, 3.9274984650560403`*^9, 
   3.9274985940440454`*^9, 3.927499139730438*^9, 3.930088054075172*^9, {
   3.9300881097817054`*^9, 3.9300881280663333`*^9}, {3.9300882105284395`*^9, 
   3.930088249505662*^9}, {3.93008848737978*^9, 3.930088502922086*^9}, {
   3.93008855427505*^9, 3.9300885743653526`*^9}, {3.930088618474655*^9, 
   3.930088623484474*^9}, {3.9300887271985703`*^9, 3.9300887387174683`*^9}, 
   3.9300887820416036`*^9, 3.9300888422030067`*^9, 3.930088878982376*^9, 
   3.9300902312357187`*^9, 3.9300906226307154`*^9, 3.930090728688937*^9, 
   3.9300908797246437`*^9, 3.930091100640115*^9, 3.9300913495113134`*^9, {
   3.9300914051936855`*^9, 3.9300914182931356`*^9}, {3.930091483546569*^9, 
   3.9300915450498405`*^9}, 3.930091593087634*^9, {3.9300916313769484`*^9, 
   3.9300917085128665`*^9}, {3.930091760390743*^9, 3.930091762249367*^9}, 
   3.930091801594449*^9, 3.9300918526138983`*^9, {3.930092349712901*^9, 
   3.9300923574434757`*^9}, {3.9300923895399866`*^9, 
   3.9300923917047505`*^9}, {3.9300932514645257`*^9, 3.9300932562833295`*^9}, 
   3.930095090566177*^9, 3.9300961994243965`*^9, {3.9300962307469416`*^9, 
   3.930096279498295*^9}, {3.9300963211839952`*^9, 3.9300964102809753`*^9}, 
   3.9300964519005413`*^9, {3.9300966708356295`*^9, 3.9300967448387885`*^9}, {
   3.9300971116884513`*^9, 3.930097153244089*^9}},
 CellLabel->
  "Out[1387]=",ExpressionUUID->"3d58c946-3f7c-4364-9859-024e63bef4b2"],

Cell[BoxData["1.5707962267948967`"], "Output",
 CellChangeTimes->{
  3.927455600169839*^9, 3.9274563189409957`*^9, 3.9274974529990573`*^9, 
   3.9274974908612156`*^9, 3.927497621805256*^9, 3.9274984650560403`*^9, 
   3.9274985940440454`*^9, 3.927499139730438*^9, 3.930088054075172*^9, {
   3.9300881097817054`*^9, 3.9300881280663333`*^9}, {3.9300882105284395`*^9, 
   3.930088249505662*^9}, {3.93008848737978*^9, 3.930088502922086*^9}, {
   3.93008855427505*^9, 3.9300885743653526`*^9}, {3.930088618474655*^9, 
   3.930088623484474*^9}, {3.9300887271985703`*^9, 3.9300887387174683`*^9}, 
   3.9300887820416036`*^9, 3.9300888422030067`*^9, 3.930088878982376*^9, 
   3.9300902312357187`*^9, 3.9300906226307154`*^9, 3.930090728688937*^9, 
   3.9300908797246437`*^9, 3.930091100640115*^9, 3.9300913495113134`*^9, {
   3.9300914051936855`*^9, 3.9300914182931356`*^9}, {3.930091483546569*^9, 
   3.9300915450498405`*^9}, 3.930091593087634*^9, {3.9300916313769484`*^9, 
   3.9300917085128665`*^9}, {3.930091760390743*^9, 3.930091762249367*^9}, 
   3.930091801594449*^9, 3.9300918526138983`*^9, {3.930092349712901*^9, 
   3.9300923574434757`*^9}, {3.9300923895399866`*^9, 
   3.9300923917047505`*^9}, {3.9300932514645257`*^9, 3.9300932562833295`*^9}, 
   3.930095090566177*^9, 3.9300961994243965`*^9, {3.9300962307469416`*^9, 
   3.930096279498295*^9}, {3.9300963211839952`*^9, 3.9300964102809753`*^9}, 
   3.9300964519005413`*^9, {3.9300966708356295`*^9, 3.9300967448387885`*^9}, {
   3.9300971116884513`*^9, 3.930097153244089*^9}},
 CellLabel->
  "Out[1388]=",ExpressionUUID->"5d89550f-7f27-4d94-9911-14e66c75b3e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pa1", " ", "=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", "1"}
       }], ")"}], "+", 
     RowBox[{"xa", " ", 
      RowBox[{"(", GridBox[{
         {"0", "1"},
         {"1", "0"}
        }], ")"}]}], "+", 
     RowBox[{"ya", 
      RowBox[{"(", GridBox[{
         {"0", 
          RowBox[{
           RowBox[{"-", "1"}], " ", "I"}]},
         {
          RowBox[{"1", " ", "I"}], "0"}
        }], ")"}]}], "+", 
     RowBox[{"za", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        }], ")"}]}]}], "2"]}], 
  RowBox[{
  "(*", "\:77e9\:96351\:7684\:6295\:5f71\:77e9\:9635", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Pb1", " ", "=", " ", 
  FractionBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", "1"}
      }], ")"}], "+", 
    RowBox[{"xb", " ", 
     RowBox[{"(", GridBox[{
        {"0", "1"},
        {"1", "0"}
       }], ")"}]}], "+", 
    RowBox[{"yb", 
     RowBox[{"(", GridBox[{
        {"0", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "I"}]},
        {
         RowBox[{"1", " ", "I"}], "0"}
       }], ")"}]}], "+", 
    RowBox[{"zb", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}]}], "2"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unit", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {"0", "1"}
     }], ")"}]}], "\:ff1b", "\[IndentingNewLine]", 
  RowBox[{"state", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1"}], "}"}]}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.927456151384161*^9, 3.927456151637088*^9}, 
   3.9274563156295652`*^9, {3.927456355214899*^9, 3.9274563553468075`*^9}, {
   3.9274974156616597`*^9, 3.9274974257815685`*^9}, {3.9274983026715083`*^9, 
   3.9274983028262672`*^9}, {3.9274983737307606`*^9, 3.927498373894081*^9}, {
   3.927498412122316*^9, 3.927498455796809*^9}, {3.9274985802989087`*^9, 
   3.927498618676936*^9}, {3.9274987498209066`*^9, 3.9274987499768896`*^9}, {
   3.9278905622798057`*^9, 3.9278905624673576`*^9}, {3.9278906370026517`*^9, 
   3.927890654156225*^9}, {3.930088158323382*^9, 3.930088162074397*^9}, 
   3.93008825329388*^9, {3.930088660063037*^9, 3.930088660933919*^9}, {
   3.930088700939821*^9, 3.9300887053236914`*^9}, {3.930097022954481*^9, 
   3.930097047996028*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[1389]:=",ExpressionUUID->"9654bd92-8d36-4666-91fb-71ef4b6c3782"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.927455641096569*^9, 3.9274561563149233`*^9, 3.92745631994061*^9, 
   3.9274563576890163`*^9, {3.927497430093416*^9, 3.927497454235256*^9}, 
   3.9274974924814105`*^9, 3.927497628718044*^9, 3.9274983038689413`*^9, 
   3.9274983748992777`*^9, {3.927498428649178*^9, 3.9274984673049097`*^9}, {
   3.9274985894636745`*^9, 3.9274986233702173`*^9}, 3.927498761969596*^9, 
   3.9274991419860864`*^9, 3.930088059605896*^9, 3.930088134777495*^9, 
   3.930088171560041*^9, {3.9300882126335955`*^9, 3.9300882537339745`*^9}, {
   3.930088471788604*^9, 3.9300885056440544`*^9}, {3.9300885562738028`*^9, 
   3.9300886296177783`*^9}, {3.9300887139386005`*^9, 3.9300887411712804`*^9}, 
   3.9300887851330595`*^9, 3.930088844643976*^9, 3.930088881271265*^9, 
   3.930090234016075*^9, 3.9300906256397424`*^9, 3.9300907308503375`*^9, 
   3.9300908357340174`*^9, 3.930090881901061*^9, 3.9300911026537056`*^9, 
   3.9300915493802366`*^9, 3.930091596737859*^9, {3.9300916585444536`*^9, 
   3.9300916781148214`*^9}, 3.930091713033128*^9, 3.930091764330183*^9, 
   3.9300918063453846`*^9, 3.930091855646457*^9, 3.93009236181328*^9, 
   3.930092401313821*^9, 3.9300932640343924`*^9, 3.930095093523096*^9, 
   3.9300962130612793`*^9, {3.930096251357144*^9, 3.9300962931079893`*^9}, {
   3.9300963779167075`*^9, 3.9300964022615433`*^9}, 3.930097155383678*^9},
 CellLabel->
  "Out[1389]=",ExpressionUUID->"160e7f2b-05b0-412a-8f0f-4802e6218630"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9999999999999976`", ",", 
     RowBox[{"4.999999999999966`*^-8", "-", 
      RowBox[{"4.999999999999983`*^-15", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"4.999999999999966`*^-8", "+", 
      RowBox[{"4.999999999999983`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
     "2.4980018054066022`*^-15"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.927455641096569*^9, 3.9274561563149233`*^9, 3.92745631994061*^9, 
   3.9274563576890163`*^9, {3.927497430093416*^9, 3.927497454235256*^9}, 
   3.9274974924814105`*^9, 3.927497628718044*^9, 3.9274983038689413`*^9, 
   3.9274983748992777`*^9, {3.927498428649178*^9, 3.9274984673049097`*^9}, {
   3.9274985894636745`*^9, 3.9274986233702173`*^9}, 3.927498761969596*^9, 
   3.9274991419860864`*^9, 3.930088059605896*^9, 3.930088134777495*^9, 
   3.930088171560041*^9, {3.9300882126335955`*^9, 3.9300882537339745`*^9}, {
   3.930088471788604*^9, 3.9300885056440544`*^9}, {3.9300885562738028`*^9, 
   3.9300886296177783`*^9}, {3.9300887139386005`*^9, 3.9300887411712804`*^9}, 
   3.9300887851330595`*^9, 3.930088844643976*^9, 3.930088881271265*^9, 
   3.930090234016075*^9, 3.9300906256397424`*^9, 3.9300907308503375`*^9, 
   3.9300908357340174`*^9, 3.930090881901061*^9, 3.9300911026537056`*^9, 
   3.9300915493802366`*^9, 3.930091596737859*^9, {3.9300916585444536`*^9, 
   3.9300916781148214`*^9}, 3.930091713033128*^9, 3.930091764330183*^9, 
   3.9300918063453846`*^9, 3.930091855646457*^9, 3.93009236181328*^9, 
   3.930092401313821*^9, 3.9300932640343924`*^9, 3.930095093523096*^9, 
   3.9300962130612793`*^9, {3.930096251357144*^9, 3.9300962931079893`*^9}, {
   3.9300963779167075`*^9, 3.9300964022615433`*^9}, 3.9300971553936787`*^9},
 CellLabel->
  "Out[1390]=",ExpressionUUID->"0b5c1096-6d76-4f1f-8d7e-c9d2478efd1c"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\" \
\\\", \\\"\:ff1b\\\", \\\" \\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}]\\) \:4e2d\:957f\:5ea6\:4e0d\
\:76f8\:7b49\:7684\:5bf9\:8c61\:65e0\:6cd5\:5408\:5e76.\"", 2, 1391, 88, 
   18240910962965106497, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.92749743011962*^9, 3.9274974542402573`*^9}, 
   3.927497492486411*^9, 3.927497628722045*^9, 3.9274983038739424`*^9, 
   3.9274983749042797`*^9, {3.9274984286541786`*^9, 3.927498467308911*^9}, {
   3.927498589469676*^9, 3.9274986233802204`*^9}, 3.9274987619785976`*^9, 
   3.927499141996089*^9, 3.930088059605896*^9, 3.930088134787496*^9, 
   3.930088171570038*^9, {3.9300882126335955`*^9, 3.930088253743975*^9}, {
   3.930088471798604*^9, 3.9300885056540575`*^9}, {3.930088556283803*^9, 
   3.930088629627778*^9}, {3.9300887139486012`*^9, 3.9300887411818504`*^9}, 
   3.9300887851430683`*^9, 3.9300888446539764`*^9, 3.9300888812912693`*^9, 
   3.9300902340260744`*^9, 3.930090625649743*^9, 3.9300907308603373`*^9, 
   3.930090835744019*^9, 3.9300908819110622`*^9, 3.9300911026637073`*^9, 
   3.9300915493902483`*^9, 3.93009159674786*^9, {3.930091658553973*^9, 
   3.9300916781247115`*^9}, 3.930091713043129*^9, 3.93009176434019*^9, 
   3.9300918063553934`*^9, 3.9300918556564493`*^9, 3.9300923618232803`*^9, 
   3.9300924013238187`*^9, 3.9300932640443926`*^9, 3.930095093533096*^9, 
   3.930096213071289*^9, {3.930096251367144*^9, 3.930096293118001*^9}, {
   3.930096377933079*^9, 3.9300964022715435`*^9}, 3.9300971553936787`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1389]:=",ExpressionUUID->"e98ce67d-3a01-4353-\
afeb-483b603ad275"],

Cell[BoxData[
 RowBox[{"\:ff1b", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1"}], "}"}]}]], "Output",
 CellChangeTimes->{
  3.927455641096569*^9, 3.9274561563149233`*^9, 3.92745631994061*^9, 
   3.9274563576890163`*^9, {3.927497430093416*^9, 3.927497454235256*^9}, 
   3.9274974924814105`*^9, 3.927497628718044*^9, 3.9274983038689413`*^9, 
   3.9274983748992777`*^9, {3.927498428649178*^9, 3.9274984673049097`*^9}, {
   3.9274985894636745`*^9, 3.9274986233702173`*^9}, 3.927498761969596*^9, 
   3.9274991419860864`*^9, 3.930088059605896*^9, 3.930088134777495*^9, 
   3.930088171560041*^9, {3.9300882126335955`*^9, 3.9300882537339745`*^9}, {
   3.930088471788604*^9, 3.9300885056440544`*^9}, {3.9300885562738028`*^9, 
   3.9300886296177783`*^9}, {3.9300887139386005`*^9, 3.9300887411712804`*^9}, 
   3.9300887851330595`*^9, 3.930088844643976*^9, 3.930088881271265*^9, 
   3.930090234016075*^9, 3.9300906256397424`*^9, 3.9300907308503375`*^9, 
   3.9300908357340174`*^9, 3.930090881901061*^9, 3.9300911026537056`*^9, 
   3.9300915493802366`*^9, 3.930091596737859*^9, {3.9300916585444536`*^9, 
   3.9300916781148214`*^9}, 3.930091713033128*^9, 3.930091764330183*^9, 
   3.9300918063453846`*^9, 3.930091855646457*^9, 3.93009236181328*^9, 
   3.930092401313821*^9, 3.9300932640343924`*^9, 3.930095093523096*^9, 
   3.9300962130612793`*^9, {3.930096251357144*^9, 3.9300962931079893`*^9}, {
   3.9300963779167075`*^9, 3.9300964022615433`*^9}, 3.9300971554036875`*^9},
 CellLabel->
  "Out[1391]=",ExpressionUUID->"ec858669-84ea-4c5b-8013-b1b35d3a9f42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pa1", " ", "=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", "1"}
       }], ")"}], "+", 
     RowBox[{"xa", " ", 
      RowBox[{"(", GridBox[{
         {"0", "1"},
         {"1", "0"}
        }], ")"}]}], "+", 
     RowBox[{"ya", 
      RowBox[{"(", GridBox[{
         {"0", 
          RowBox[{
           RowBox[{"-", "1"}], " ", "I"}]},
         {
          RowBox[{"1", " ", "I"}], "0"}
        }], ")"}]}], "+", 
     RowBox[{"za", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        }], ")"}]}]}], "2"]}], 
  RowBox[{
  "(*", "\:77e9\:96351\:7684\:6295\:5f71\:77e9\:9635", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unit", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {"0", "1"}
     }], ")"}]}], "\:ff1b", "\[IndentingNewLine]", 
  RowBox[{"state", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}], "/", 
    SqrtBox["2"]}]}], "\:ff1b"}]}], "Input",
 CellChangeTimes->{{3.927455611673065*^9, 3.9274556164567046`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"08de82f2-7333-40a4-bbe4-08e42c17cd58"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.8248156086056213`", ",", 
     RowBox[{"0.0907628950809295`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.3691299463369072`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.0907628950809295`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.3691299463369072`", " ", "\[ImaginaryI]"}]}], ",", 
     "0.17518439139437864`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9274556175407653`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"06561201-4d22-480f-be36-191e0b1674d7"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\" \
\\\", \\\"\:ff1b\\\", \\\" \\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"2\\\"]], \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"2\\\"]]}], \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\" \\\", \\\"\:ff1b\\\"}]\\) \:4e2d\:957f\:5ea6\
\:4e0d\:76f8\:7b49\:7684\:5bf9\:8c61\:65e0\:6cd5\:5408\:5e76.\"", 2, 7, 1, 
   18223660855389489698, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.927455617579774*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[6]:=",ExpressionUUID->"d91d240c-9052-462b-80c9-\
36f10a481dc5"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"\\!\\(\\*RowBox[{SuperscriptBox[\\\"\:ff1b\\\", \\\"2\\\"], \\\" \\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\" \\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", FractionBox[\\\"1\\\", \
SqrtBox[\\\"2\\\"]], \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
SqrtBox[\\\"2\\\"]]}], \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}]\\) \:4e2d\:957f\
\:5ea6\:4e0d\:76f8\:7b49\:7684\:5bf9\:8c61\:65e0\:6cd5\:5408\:5e76.\"", 2, 7, 
   2, 18223660855389489698, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.9274556176037793`*^9, 3.9274556364934187`*^9}, 
   3.9274557321182337`*^9},ExpressionUUID->"ad3b732d-3681-4450-9ee5-\
23ea8fcbc96f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\:ff1b", "2"], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}], " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    FractionBox["1", 
     SqrtBox["2"]], ",", 
    RowBox[{"-", 
     FractionBox["1", 
      SqrtBox["2"]]}], ",", "0"}], "}"}]}]], "Output",
 CellChangeTimes->{3.9274556176157823`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"0fcf077d-2068-40ae-b329-f2b8d080cf27"]
}, {4}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kron", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Pa1", ",", "Pb1"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Kron", " ", "multiplied", " ", "by"}], " ", "|", "state"}], 
    "\[RightAngleBracket]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step1", " ", "=", " ", 
   RowBox[{"Dot", "[", 
    RowBox[{"Kron", ",", "state"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"state", "|", " ", 
     RowBox[{"multiplied", " ", "by", " ", "Kron"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"step2", " ", "=", "  ", 
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", "state", "]"}], ",", "step1"}], 
   "]"}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9274557487304153`*^9, 3.927455784885725*^9}, {
  3.927497529045555*^9, 3.9274975421117535`*^9}, {3.9274986346592717`*^9, 
  3.92749865413435*^9}, {3.9274987580439343`*^9, 3.9274987745437136`*^9}, {
  3.927890554909688*^9, 3.927890560815254*^9}, {3.9300881806181655`*^9, 
  3.9300882033946543`*^9}, {3.93008846298973*^9, 3.9300884681189456`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[1392]:=",ExpressionUUID->"bed2e422-7b91-4be6-a9e8-738d55f5c9a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999976`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.999999999999966`*^-8", "-", 
      RowBox[{"4.999999999999983`*^-15", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.999999999999966`*^-8", "+", 
      RowBox[{"4.999999999999983`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.4980018054066022`*^-15", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9274557374630527`*^9, 3.927456158709615*^9, 3.927456320963662*^9, 
   3.9274563587740192`*^9, {3.9274974415595164`*^9, 3.927497456786027*^9}, 
   3.9274975507844024`*^9, {3.9274976253409033`*^9, 3.9274976308466187`*^9}, 
   3.92749831159869*^9, 3.927498377457077*^9, {3.92749844842396*^9, 
   3.927498469745924*^9}, 3.9274985912380424`*^9, {3.9274986380094943`*^9, 
   3.9274986544969115`*^9}, {3.9274987641660223`*^9, 3.9274987766385093`*^9}, 
   3.927499144128722*^9, 3.9300880617558465`*^9, 3.9300881366259403`*^9, {
   3.930088173750514*^9, 3.9300882584890623`*^9}, {3.9300884699400654`*^9, 
   3.9300885073638573`*^9}, {3.930088558540963*^9, 3.9300885785572505`*^9}, {
   3.930088614072322*^9, 3.9300886319251556`*^9}, {3.930088715906787*^9, 
   3.9300887436668725`*^9}, 3.93008878801857*^9, 3.9300888468424683`*^9, 
   3.9300888842820587`*^9, 3.930090235996729*^9, 3.9300906284758697`*^9, 
   3.930090732769014*^9, 3.9300908385828066`*^9, 3.9300908840637836`*^9, 
   3.9300911044143248`*^9, 3.9300915526694946`*^9, 3.9300915987396436`*^9, {
   3.9300916605492477`*^9, 3.930091680016306*^9}, 3.930091715365143*^9, 
   3.9300917668590493`*^9, 3.9300918093135467`*^9, 3.9300918576945753`*^9, 
   3.930092364335971*^9, 3.9300924049830303`*^9, 3.930093265254656*^9, 
   3.9300950954540052`*^9, 3.930096215402376*^9, {3.930096252638765*^9, 
   3.9300962943696737`*^9}, {3.9300963796083775`*^9, 3.930096404148692*^9}, 
   3.930097157134094*^9},
 CellLabel->
  "Out[1392]=",ExpressionUUID->"2e896741-ff09-427f-b43c-12852daa1858"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"4.999999999999966`*^-8", "-", 
    RowBox[{"4.999999999999983`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.4980018054066022`*^-15", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9274557374630527`*^9, 3.927456158709615*^9, 3.927456320963662*^9, 
   3.9274563587740192`*^9, {3.9274974415595164`*^9, 3.927497456786027*^9}, 
   3.9274975507844024`*^9, {3.9274976253409033`*^9, 3.9274976308466187`*^9}, 
   3.92749831159869*^9, 3.927498377457077*^9, {3.92749844842396*^9, 
   3.927498469745924*^9}, 3.9274985912380424`*^9, {3.9274986380094943`*^9, 
   3.9274986544969115`*^9}, {3.9274987641660223`*^9, 3.9274987766385093`*^9}, 
   3.927499144128722*^9, 3.9300880617558465`*^9, 3.9300881366259403`*^9, {
   3.930088173750514*^9, 3.9300882584890623`*^9}, {3.9300884699400654`*^9, 
   3.9300885073638573`*^9}, {3.930088558540963*^9, 3.9300885785572505`*^9}, {
   3.930088614072322*^9, 3.9300886319251556`*^9}, {3.930088715906787*^9, 
   3.9300887436668725`*^9}, 3.93008878801857*^9, 3.9300888468424683`*^9, 
   3.9300888842820587`*^9, 3.930090235996729*^9, 3.9300906284758697`*^9, 
   3.930090732769014*^9, 3.9300908385828066`*^9, 3.9300908840637836`*^9, 
   3.9300911044143248`*^9, 3.9300915526694946`*^9, 3.9300915987396436`*^9, {
   3.9300916605492477`*^9, 3.930091680016306*^9}, 3.930091715365143*^9, 
   3.9300917668590493`*^9, 3.9300918093135467`*^9, 3.9300918576945753`*^9, 
   3.930092364335971*^9, 3.9300924049830303`*^9, 3.930093265254656*^9, 
   3.9300950954540052`*^9, 3.930096215402376*^9, {3.930096252638765*^9, 
   3.9300962943696737`*^9}, {3.9300963796083775`*^9, 3.930096404148692*^9}, 
   3.930097157134094*^9},
 CellLabel->
  "Out[1393]=",ExpressionUUID->"6dbc1a79-1416-4b05-91fe-c1743a005e93"],

Cell[BoxData[
 RowBox[{"2.4980018054066022`*^-15", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.9274557374630527`*^9, 3.927456158709615*^9, 3.927456320963662*^9, 
   3.9274563587740192`*^9, {3.9274974415595164`*^9, 3.927497456786027*^9}, 
   3.9274975507844024`*^9, {3.9274976253409033`*^9, 3.9274976308466187`*^9}, 
   3.92749831159869*^9, 3.927498377457077*^9, {3.92749844842396*^9, 
   3.927498469745924*^9}, 3.9274985912380424`*^9, {3.9274986380094943`*^9, 
   3.9274986544969115`*^9}, {3.9274987641660223`*^9, 3.9274987766385093`*^9}, 
   3.927499144128722*^9, 3.9300880617558465`*^9, 3.9300881366259403`*^9, {
   3.930088173750514*^9, 3.9300882584890623`*^9}, {3.9300884699400654`*^9, 
   3.9300885073638573`*^9}, {3.930088558540963*^9, 3.9300885785572505`*^9}, {
   3.930088614072322*^9, 3.9300886319251556`*^9}, {3.930088715906787*^9, 
   3.9300887436668725`*^9}, 3.93008878801857*^9, 3.9300888468424683`*^9, 
   3.9300888842820587`*^9, 3.930090235996729*^9, 3.9300906284758697`*^9, 
   3.930090732769014*^9, 3.9300908385828066`*^9, 3.9300908840637836`*^9, 
   3.9300911044143248`*^9, 3.9300915526694946`*^9, 3.9300915987396436`*^9, {
   3.9300916605492477`*^9, 3.930091680016306*^9}, 3.930091715365143*^9, 
   3.9300917668590493`*^9, 3.9300918093135467`*^9, 3.9300918576945753`*^9, 
   3.930092364335971*^9, 3.9300924049830303`*^9, 3.930093265254656*^9, 
   3.9300950954540052`*^9, 3.930096215402376*^9, {3.930096252638765*^9, 
   3.9300962943696737`*^9}, {3.9300963796083775`*^9, 3.930096404148692*^9}, 
   3.9300971571440945`*^9},
 CellLabel->
  "Out[1394]=",ExpressionUUID->"a20bf103-c791-4e28-a0da-d9387684c1da"]
}, Open  ]]
},
WindowSize->{1269, 721},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.8 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (2022\:5e7411\:670818\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"34af2923-c8da-4ee1-8fb5-2461660f4e1f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4365, 96, 408, "Input",ExpressionUUID->"158d709d-4703-41e1-b1c8-3a1ba8ccaa91"],
Cell[4948, 120, 1612, 23, 38, "Output",ExpressionUUID->"3d58c946-3f7c-4364-9859-024e63bef4b2"],
Cell[6563, 145, 1609, 23, 36, "Output",ExpressionUUID->"5d89550f-7f27-4d94-9911-14e66c75b3e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8209, 173, 2603, 81, 174, "Input",ExpressionUUID->"9654bd92-8d36-4666-91fb-71ef4b6c3782"],
Cell[10815, 256, 1612, 27, 36, "Output",ExpressionUUID->"160e7f2b-05b0-412a-8f0f-4802e6218630"],
Cell[12430, 285, 1881, 33, 40, "Output",ExpressionUUID->"0b5c1096-6d76-4f1f-8d7e-c9d2478efd1c"],
Cell[14314, 320, 2007, 31, 23, "Message",ExpressionUUID->"e98ce67d-3a01-4353-afeb-483b603ad275"],
Cell[16324, 353, 1744, 31, 36, "Output",ExpressionUUID->"ec858669-84ea-4c5b-8013-b1b35d3a9f42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18105, 389, 1255, 44, 102, "Input",ExpressionUUID->"08de82f2-7333-40a4-bbe4-08e42c17cd58"],
Cell[19363, 435, 578, 13, 25, "Output",ExpressionUUID->"06561201-4d22-480f-be36-191e0b1674d7"],
Cell[19944, 450, 884, 16, 35, "Message",ExpressionUUID->"d91d240c-9052-462b-80c9-36f10a481dc5"],
Cell[20831, 468, 940, 17, 37, "Message",ExpressionUUID->"ad3b732d-3681-4450-9ee5-23ea8fcbc96f"],
Cell[21774, 487, 525, 17, 41, "Output",ExpressionUUID->"0fcf077d-2068-40ae-b329-f2b8d080cf27"]
}, {4}]],
Cell[CellGroupData[{
Cell[22333, 509, 1332, 32, 147, "Input",ExpressionUUID->"bed2e422-7b91-4be6-a9e8-738d55f5c9a9"],
Cell[23668, 543, 3404, 66, 40, "Output",ExpressionUUID->"2e896741-ff09-427f-b43c-12852daa1858"],
Cell[27075, 611, 2005, 33, 40, "Output",ExpressionUUID->"6dbc1a79-1416-4b05-91fe-c1743a005e93"],
Cell[29083, 646, 1664, 25, 38, "Output",ExpressionUUID->"a20bf103-c791-4e28-a0da-d9387684c1da"]
}, Open  ]]
}
]
*)

